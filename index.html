<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FLASH - Fluxo de Caixa</title>
    <link rel="manifest" href="../manifest.json">
    <link rel="stylesheet" href="../style.css">
    <style>
    @media (max-width: 600px) {
        html, body {
            max-width: 100vw;
            overflow-x: hidden;
        }
        body {
            font-size: 0.98rem;
        }
        section, footer {
            max-width: 100vw !important;
            min-width: 0;
            padding: 16px 2vw 12px 2vw !important;
            box-sizing: border-box;
        }
        h1 {
            font-size: 1.2rem;
            padding: 18px 0 10px 0;
        }
        nav a, button {
            font-size: 0.98rem;
            padding: 8px 10px;
        }
        header img {
            width: 44px !important;
            height: 44px !important;
        }
        form {
            flex-wrap: wrap;
        }
        form input, form button {
            min-width: 0;
            flex: 1 1 100%;
            margin-bottom: 6px;
        }
        .page-switcher {
            flex-wrap: wrap;
            gap: 6px;
        }
        .page-switcher a {
            min-width: 44vw;
            text-align: center;
        }
        .flash-btn {
            width: 100%;
            min-width: 0;
        }
    }
    .page-switcher {
        display: flex;
        justify-content: center;
        gap: 12px;
        margin: 18px 0 0 0;
    }
    .page-switcher a {
        background: #232946;
        color: #eebbc3;
        border: 1.5px solid #393e5c;
        border-radius: 8px;
        padding: 8px 22px;
        font-weight: bold;
        text-decoration: none;
        font-size: 1.08rem;
        transition: background 0.2s, color 0.2s, border 0.2s;
        box-shadow: 0 2px 8px #0002;
    }
    .page-switcher a.active, .page-switcher a:hover {
        background: #ff3b3b;
        color: #fff;
        border: 1.5px solid #ff3b3b;
    }
    .flash-red {
        color: #ff3b3b !important;
    }
    .flash-border {
        border-color: #ff3b3b !important;
    }
    .flash-section {
        box-shadow: 0 4px 24px #ff3b3b33;
        border: 1.5px solid #ff3b3b;
    }
    .flash-btn {
        background: linear-gradient(90deg, #ff3b3b 60%, #eebbc3 100%) !important;
        color: #fff !important;
        border: none !important;
    }
    .flash-btn:hover {
        background: linear-gradient(90deg, #eebbc3 60%, #ff3b3b 100%) !important;
        color: #232946 !important;
    }
    </style>
</head>
<body>
    <div class="page-switcher">
        <a href="../salario/salario.html">SALÁRIO</a>
        <a href="../flash/flash.html" class="active">FLASH</a>
    </div>
    <header style="display:flex;flex-direction:column;align-items:center;gap:8px;margin-bottom:10px;animation:fadeInDown 1s;">
            <section style="max-width:420px;margin:0 auto 18px auto;background:#232946;padding:18px 18px 10px 18px;border-radius:12px;box-shadow:0 2px 8px #0003;animation:fadeInDown 1.1s;">
                <form id="form-receita-flash" style="display:flex;gap:10px;align-items:center;">
                    <input type="number" name="receita" id="input-receita-flash" placeholder="Informe sua receita" required step="0.01" min="0" style="flex:1;" class="flash-border">
                    <button type="submit" class="flash-btn">Salvar Receita</button>
                </form>
                <div style="margin-top:8px;font-size:1.05rem;display:flex;align-items:center;gap:10px;">
                    <strong>Receita atual:</strong> <span id="valor-receita-flash">R$ 0,00</span>
                    <button id="btn-excluir-receita-flash" type="button" class="flash-btn" style="padding:4px 10px;font-size:0.95rem;">Excluir</button>
                </div>
            </section>
        <img src="https://img.icons8.com/ios-filled/100/ff3b3b/wallet--v1.png" alt="Carteira" style="width:64px;height:64px;filter:drop-shadow(0 2px 8px #ff3b3b66);">
        <h1 style="margin:0;">FLASH <span class="flash-red">- Despesas Fixas</span></h1>
        <span style="color:#b8c1ec;font-size:1.1rem;letter-spacing:1px;">Seu controle rápido e visual</span>
    </header>
    <section id="despesas-fixas" class="flash-section" style="animation:fadeInUp 1.1s;">
        <h2 class="flash-red">Cadastrar Despesa Fixa</h2>
        <form id="form-fixa-flash">
            <input type="text" name="nome" placeholder="Nome da despesa" required class="flash-border">
            <input type="number" name="valor" placeholder="Valor" required step="0.01" class="flash-border">
            <input type="date" name="vencimento" placeholder="Data de vencimento" required class="flash-border">
            <button type="submit" class="flash-btn">Cadastrar</button>
        </form>
        <ul id="lista-fixa-flash"></ul>
    </section>
    <section id="despesas-variaveis" class="flash-section" style="animation:fadeInUp 1.3s;">
        <h2 class="flash-red">Cadastrar Despesa Variável</h2>
        <form id="form-variavel-flash">
            <input type="text" name="nome" placeholder="Nome da despesa" required class="flash-border">
            <input type="number" name="valor" placeholder="Valor" required step="0.01" class="flash-border">
            <input type="date" name="vencimento" placeholder="Data de vencimento" required class="flash-border">
            <button type="submit" class="flash-btn">Cadastrar</button>
        </form>
        <ul id="lista-variavel-flash"></ul>
    </section>
    <nav style="animation:fadeInUp 1.5s;">
        <a href="../salario/salario.html">Ir para Salário</a>
    </nav>
    <footer style="margin:32px auto 18px auto;max-width:420px;text-align:center;background:#232946;padding:18px 0 10px 0;border-radius:12px;box-shadow:0 2px 8px #0003;">
                <div style="margin-top:16px;font-size:1.1rem;">
                    <strong>Saldo final:</strong> <span id="saldo-flash">R$ 0,00</span>
                </div>
        <div style="margin-bottom:8px;">
            <strong>Total despesas fixas:</strong> <span id="total-fixa-flash">R$ 0,00</span>
        </div>
        <div>
            <strong>Total despesas variáveis:</strong> <span id="total-variavel-flash">R$ 0,00</span>
        </div>
    </footer>
    <script>
    function somarDespesas(tipo, pagina) {
        const lista = JSON.parse(localStorage.getItem(`${pagina}_${tipo}`)) || [];
        return lista.reduce((acc, item) => acc + (parseFloat(item.valor) || 0), 0);
    }
    function getReceita(pagina) {
        return parseFloat(localStorage.getItem(`${pagina}_receita`)) || 0;
    }
    function setReceita(pagina, valor) {
        localStorage.setItem(`${pagina}_receita`, valor);
    }
    function atualizarTotaisFlash() {
        const totalFixa = somarDespesas('fixa', 'flash');
        const totalVariavel = somarDespesas('variavel', 'flash');
        const receita = getReceita('flash');
        document.getElementById('total-fixa-flash').textContent = 'R$ ' + totalFixa.toLocaleString('pt-BR', {minimumFractionDigits:2});
        document.getElementById('total-variavel-flash').textContent = 'R$ ' + totalVariavel.toLocaleString('pt-BR', {minimumFractionDigits:2});
        document.getElementById('valor-receita-flash').textContent = 'R$ ' + receita.toLocaleString('pt-BR', {minimumFractionDigits:2});
        const saldo = receita - totalFixa - totalVariavel;
        document.getElementById('saldo-flash').textContent = 'R$ ' + saldo.toLocaleString('pt-BR', {minimumFractionDigits:2});
    }
    atualizarTotaisFlash();
    // Atualiza totais ao cadastrar/remover
    const observer = new MutationObserver(atualizarTotaisFlash);
    observer.observe(document.getElementById('lista-fixa-flash'), {childList:true});
    observer.observe(document.getElementById('lista-variavel-flash'), {childList:true});
    // Receita
    document.getElementById('form-receita-flash').onsubmit = function(e) {
        e.preventDefault();
        const valor = parseFloat(document.getElementById('input-receita-flash').value) || 0;
        setReceita('flash', valor);
        atualizarTotaisFlash();
        this.reset();
    };
    // Excluir receita
    document.getElementById('btn-excluir-receita-flash').onclick = function() {
        setReceita('flash', 0);
        atualizarTotaisFlash();
    };
    // Atualiza receita ao carregar
    atualizarTotaisFlash();
    </script>
    <script src="../script.js"></script>
            <script>
            if ('serviceWorker' in navigator) {
                window.addEventListener('load', function() {
                    navigator.serviceWorker.register('../service-worker.js');
                });
            }
            </script>
    <style>
    @keyframes fadeInDown {
        from { opacity: 0; transform: translateY(-40px); }
        to { opacity: 1; transform: translateY(0); }
    }
    @keyframes fadeInUp {
        from { opacity: 0; transform: translateY(40px); }
        to { opacity: 1; transform: translateY(0); }
    }
    </style>
</body>
</html>